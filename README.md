# HCSR04-STM32
Example of using the interrupt driven output compare &amp; input capture modes of a general purpose timer on a STM32 L432KC board to drive a HCSR04 ultrasonic sensor,
with logging output of measured distance values over USART.


## Driver files:
The demo project follows the standard structure generated by the STM32CubeIDE,
as such all of the application files can be found inside of the Src & Inc subdirectories of the core directory:
### Core/Inc directory
**application.h** - Declares application functions & macros, as well as volatile variables for use in interrupts

**ring_buffer.h** - Declares & defines the interface of a ring buffer for logging application output to USART

**main.h** - Defines the application pin out as macros for interfacing to the HCSR04 sensor

### Core/Src directory
**main.c** - Implements interrupt driven FSM for HCSR04 trigger pulse & measurement cycles

**application.c** - Contains definition of volatile variables for use in interrupts, as well as functions for timer configuration and USART logging

**stm32l4xx_it.c** - Contains output compare and input capture timer interrupts for updating FSM state variable used in main.c as appropriate

## Reference datasheet for driver & demo application pinout

### Datasheet
The following datasheet was used as the primary source for the creation of the driver
https://cdn.sparkfun.com/datasheets/Sensors/Proximity/HCSR04.pdf

### Pinout
The demo application uses the following pinout defined in **core/inc/main.h** from a Nucleo L432KC board for interfacing with the HCSR04 sensor

**HCSR04_TRIG_Pin** - GPIOA PIN 0

**HCSR04_ECHO_Pin** - GPIOA PIN 1
